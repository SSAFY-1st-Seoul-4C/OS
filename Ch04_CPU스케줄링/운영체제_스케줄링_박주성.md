# 운영체제

## 4. CPU 스케줄링

##### 1. 스케줄링이란?
> 자원을 효율적으로 사용하기 위한 방식

- 여러 프로세스들이 번갈아 사용해야 하는 자원이 있을 경우, 어떤 프로세스가 이 자원을 사용할지 결정하는 것

- 일반적으로 자원이 CPU일 때 (CPU 스케줄링) 스케줄링이라고 말한다.

##### 2. 스케줄링 단계

> 스케줄링은 수행 단계에 따라 장기, 중기, 단기로 나눈다.

###### 1. 장기 스케줄링
- 어느 작업을 프로세스로 만들어 줄 것인가를 결정

- = 작업 스케줄링

###### 2. 중기 스케줄링
- 보류 상태의 프로세스들 중에서 어느 프로세스에게 메모리를 할당해 줄 것인가를 결정

###### 3. 단기 스케줄링
- 준비 상태에 있는 프로세스들 중에서 어느 프로세스에게 CPU를 할당할지 결정

- 일반적으로 프로세스 스케줄링은 단기 스케줄링을 뜻한다.

- ++단기 스케줄링은 횟수가 매우 잦으므로 한번 실행에 드는 시간을 최대한 줄이는 것이 중요++

##### 3. 스케줄링의 목적
> 시스템의 ++성능++을 높이자!!
> 그렇다면 성능의 기준은?

######1. 사용자 관점 -> 빠름 빠름 빠름

 - 반환 시간 : 요청으로부터 결과를 돌려받는 데까지 걸린 시간

 - 예측 가능성 : 요청한 일이 얼마 후쯤에는 완료될 수 있을 것이라는 예측

 - 대화형 시스템

######2. 시스템 관점 -> CPU 활용능력

 - 처리량 : 단위 시간에 완료되어진 프로세스의 개수

 - 활용도 : 주어진 시간 동안 특정 자원이 실제로 가동된 시간의 비욜로 계산한 지표

 - 일괄처리 시스템

######3. 그 외

 - CPU 사용 시간을 공평하게 나누어야 하고 균형 있게 사용되도록 해야 한다.

> 응답시간과 처리량은 서로 상충되는 관계이다.
> 응답시간을 높이려고 스케줄링을 자주하면 많은 문맥교환 비용이 생겨 처리량이 감소하게 되고,
> 처리량을 높이기 위해 수행 시간이 짧은 프로세스들을 주로 처리하면 수행 시간이 긴 프로세스는 기다리는 시간이 늘어서 전체적인 응답 시간이 길어지게 된다.

##### 4. 스케줄링 정책 기준
> 프로세스는 연산 위주, 입출력 위주 두 가지 성격의 프로세스로 나눌 수 있다.
> 스케줄링을 할 때는 어떤 종류의 프로세스를 더 우대할지, 응답시간과 처리량 중 어떤 것을 높은 우선순위로 둘지 기준을 정해야 한다.

##### 5. 스케줄링 기법
> 스케줄링 기법은 비선점과 선점 스케줄링으로 분류할 수 있다.
> 1. 비선점 스케줄링 : 프로세스가 CPU를 스스로 반납할 때 까지 계속 사용하도록 허용하는 방법
> 2. 선점 스케줄링 : CPU를 할당받아 실행 중인 프로세스로부터 CPU를 뺏어서 다른 프로세스에 할당할 수 있는 방법

######1. First Come First Service(FIFO) 스케줄링
- 비선점 방식

- 먼저 도착한 프로세스에게 먼저 CPU 할당

- 긴 프로세스가 실행될 경우 뒤의 프로세스들이 오래 기다려야 함 (평균 응답시간 길어짐)

- 각 프로세스의 실행을 예측할 수 있으면 도착순서만이 실행 순서를 결정짓는다는 관점에서 '공평하다' 라고 할 수 있다.

######2. Shortest Process Next(SJF) 스케줄링
- 비선점 방식

- 가장 짧은 프로세스를 실행시켜주는 방식
> 가장 짧은 ? CPU 요구량이 가장 적은 것

	* 프로세스의 크기(시간)을 정확히 알 수 없음에도 그 크기를 가지고 스케줄을 해야한다는 문제점이 있다.
	* 해결책 : 지수 평균 방법

- ++무한 대기 현상++ 발생 가능 (실행시간이 긴 프로세스가 CPU를 할당받지 못하는 상황)
--> 해결 방법 : 에이징(Aging)
> 에이징 : 기다린 시간만큼 우선순위를 높여 처리하도록 하는 방식

- FCFS와 비교했을 때 전체적으로 빠른 응답 시간 기대 가능 BUT 긴 프로세스일수록 예측가능성 떨어짐

	*- SPN방식의 평균 응답 시간을 줄이는 방법은?*

######3. Shortest Remaing Time 스케줄링
- 선점 방식 (SPN스케줄링의 선점 방식)

- 완료까지 남은 시간(CPU 요구량)이 가장 짧은 것을 먼저 실행시켜주는 방식

- 문맥교환 시간도 고려해야 한다.

	*- 문맥교환이 잦아서 문제라면 문맥교환을 덜 하는 방안은?*

######4. Highest Response Ratio Next 스케줄링
- 비선점 방식

- SPN과 SRT의 약점인 무한 대기 현상을 방지하기 위한 기법

- 준비 큐에 있는 프로세스들 중에서 응답률이 가장 높은 프로세스에게 높은 우선순위를 주는 방식
> 응답률 : 프로세스의 크기(CPU 요구량)에 대한 대기 시간의 비율
> 응답률 = (대기시간+CPU요구량) / CPU 요구량

- 에이징 기법 사용

######5. 라운드 로빈 스케줄링
- 선점 방식

- FCFS 스케줄링을 기반으로 CPU를 할당하되, 각 프로세스는 시간 할당량이 지나면 시간 종료 인터럽트에 의해 CPU를 뺏기게 되는 방식
> 시간 할당량 : 한 번에 쓸 수 있는 CPU 시간 크기

- 대화식 시스템, 시분할 시스템에 적합한 방식

- 시간 할당량의 크기에 따라 시스템의 성능 좌우
> 시간할당량 매우 크면 FCFS와 같아지고
> 시간할당량 작을수록 문맥교환 오버헤드 증가

*라운드 로빈 방식에서 연산위주 프로세스와 입출력 위주 프로세스 중 어떤 프로세스가 더 우대를 받을까?*

*이 문제를 해결하는 방법은?*

##### 6. 실시간 스케줄링
> 실시간 시스템 : 실행될 모든 프로세스들이 정해진 시간 내에 완료되어야 하는 시스템

> 실시간 시스템에서 스케줄링은 모든 프로세스들이 정해진 마감시한 내에 완료되도록 해야 한다.

###### 1. 정적 방법
- 프로세스가 생성될 때 부여된 우선순위가 완료 때 까지 변하지 않음

- 프로세스들의 특징과 개수를 알 수 있는 경우에 유용
- RM 알고리즘


###### 2. 동적 방법
- 우선순위가 시스템에 있는 동안 조정되도록 하는 방법

- 프로세스의 생성 시간이나 특성을 알 수 없는 경우에 사용

- EDF 알고리즘